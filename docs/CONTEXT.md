## å½“å‰çŠ¶æ€
Wave 7 å®Œæˆï¼šäº¤äº’å¼åœ°å›¾ç»„ä»¶ï¼ˆLeaflet + OpenStreetMapï¼‰å·²å®ç°ã€‚UI è´¨é‡å®¡æŸ¥å®Œæˆå¹¶ä¿®å¤ 6 é¡¹é—®é¢˜ï¼ˆæš—è‰²æ¨¡å¼/æ— éšœç¢/å“åº”å¼ï¼‰ã€‚

## æœ€è¿‘æ“ä½œè®°å½•
| # | æ—¶é—´ | æ“ä½œæ‘˜è¦ | ç±»å‹ |
|---|------|---------|------|
| 1 | 2026-02-07 | åŸºäºå°é£å¤§è„‘ç­–ç•¥è§„åˆ’ï¼Œå®Œæˆ TravelMind PRD æ’°å†™ï¼ˆAgent Teams æ¶æ„ï¼‰ | ğŸ“‹å†³ç­– |
| 2 | 2026-02-07 | åˆå§‹åŒ–é¡¹ç›®éª¨æ¶ï¼šNext.js å‰ç«¯ + Python FastAPI Agent æœåŠ¡ | âš™ï¸é…ç½® |
| 3 | 2026-02-07 | é¡¹ç›®ç›®å½•ç§»è‡³ ~/Desktop/claude-test/travel-agent/ | ğŸ–¥ï¸ç»ˆç«¯ |
| 4 | 2026-02-07 | Wave 2 å‰ç«¯ï¼šé¦–é¡µã€å¯¹è¯é¡µã€åŸå­åŒ–å¡ç‰‡ï¼ˆ5ç§ï¼‰ã€API å®¢æˆ·ç«¯ã€mock æµå¼å“åº” | ğŸ–¥ï¸ç»ˆç«¯ |
| 5 | 2026-02-07 | Wave 2 åç«¯ï¼šOrchestrator + 8ä¸ªä¸“ä¸šAgent + è®°å¿†ç³»ç»Ÿ + æ¨¡å‹è·¯ç”± | ğŸ–¥ï¸ç»ˆç«¯ |
| 6 | 2026-02-07 | ä¿®å¤ Python 3.9 å…¼å®¹æ€§ï¼ˆtyping å¯¼å…¥ + __future__ annotationsï¼‰ | ğŸ–¥ï¸ç»ˆç«¯ |
| 7 | 2026-02-07 | å‰åç«¯éªŒè¯é€šè¿‡ï¼šnext build æˆåŠŸï¼Œuvicorn å¯åŠ¨æˆåŠŸ | ğŸ–¥ï¸ç»ˆç«¯ |
| 8 | 2026-02-07 | Git æäº¤ï¼šå‰ç«¯ UI ç¬¬ä¸€ç‰ˆ + åç«¯ Agent æœåŠ¡ç¬¬ä¸€ç‰ˆ | ğŸ–¥ï¸ç»ˆç«¯ |
| 9 | 2026-02-07 | å‰åç«¯ SSE è”è°ƒï¼šChatContainer å¯¹æ¥ chatStreamï¼ŒChatMessage æ”¯æŒ uiPayloads åŠ¨æ€å¡ç‰‡æ¸²æŸ“ï¼Œtypes ä¸åç«¯å¯¹é½ | ğŸ–¥ï¸ç»ˆç«¯ |
| 10 | 2026-02-07 | è¡Œç¨‹ç»“æœé¡µå¼€å‘ï¼š/itinerary/[id] é¡µé¢ + BudgetChart ç»„ä»¶ + mock-itinerary æ•°æ®ï¼Œä¸‰ Tab è§†å›¾ + åº•éƒ¨æ“ä½œæ  | ğŸ–¥ï¸ç»ˆç«¯ |
| 11 | 2026-02-07 | ä¸ªäººä¸­å¿ƒé¡µé¢ï¼šè¡Œç¨‹åˆ—è¡¨(æœç´¢) + åå¥½è®¾ç½®(5é¡¹) + æ”¶è—å¤¹ + Navbar å¯¼èˆªæ›´æ–° | ğŸ–¥ï¸ç»ˆç«¯ |
| 12 | 2026-02-07 | å·¥å…·å±‚å¼€å‘ï¼š6ä¸ªMCPåŸå­å·¥å…· + 3ä¸ªSkillsç»„åˆæŠ€èƒ½ + registryæ³¨å†Œä¸­å¿ƒ + 6ä¸ªAgentå¯¹æ¥å·¥å…· | ğŸ–¥ï¸ç»ˆç«¯ |
| 13 | 2026-02-07 | æ¨¡æ‹Ÿæ¼”ç»ƒç³»ç»Ÿï¼šç”¨æˆ·æ¨¡æ‹Ÿå™¨(5ç”»åƒ) + ç¯å¢ƒæ¨¡æ‹Ÿå™¨(5æ•…éšœ+3åœºæ™¯) + AIè£åˆ¤è¯„ä¼°(6ç»´åº¦) + 5è°ƒè¯•API | ğŸ–¥ï¸ç»ˆç«¯ |
| 14 | 2026-02-07 | é•¿æœŸè®°å¿†ï¼šç”¨æˆ·ç”»åƒç®¡ç†(ProfileManager) + çŸ¥è¯†åº“ RAG(20+æ¡ç›®) + Agentå¯¹æ¥ | ğŸ–¥ï¸ç»ˆç«¯ |
| 15 | 2026-02-07 | äº¤äº’å¼åœ°å›¾ç»„ä»¶ï¼šLeaflet+OpenStreetMapï¼Œ26ä¸ªPOIåæ ‡ï¼Œæ—¥æœŸç­›é€‰ï¼Œè·¯çº¿è¿çº¿ï¼Œç‚¹å‡»å¼¹çª— | ğŸ–¥ï¸ç»ˆç«¯ |
| 16 | 2026-02-07 | UIå®¡æŸ¥ä¿®å¤ï¼šæš—è‰²æ¨¡å¼(StatusBadge/WeatherCard/FlightCard) + æ— éšœç¢(aria-live/aria-hidden/focus-visible) + å“åº”å¼åœ°å›¾ | ğŸ–¥ï¸ç»ˆç«¯ |

## æœªå®Œæˆäº‹é¡¹
- [x] å‰ç«¯é¦–é¡µ + å¯¹è¯é¡µå¼€å‘
- [x] Generative UI åŸå­ç»„ä»¶åº“
- [x] API å®¢æˆ·ç«¯å°è£…
- [x] Agent æœåŠ¡å¼€å‘ï¼ˆOrchestrator + 8 ä¸ªä¸“ä¸š Agentï¼‰
- [x] è®°å¿†ç³»ç»Ÿï¼ˆçŸ­æœŸä¼šè¯ + çŠ¶æ€æ± ï¼‰
- [x] å‰åç«¯è”è°ƒï¼ˆæ›¿æ¢ mock ä¸ºçœŸå® SSE æµï¼‰
- [x] è¡Œç¨‹ç»“æœé¡µï¼ˆ/itinerary/[id]ï¼‰
- [x] å·¥å…·å±‚å¼€å‘ï¼ˆMCP / Skillsï¼‰
- [x] ä¸ªäººä¸­å¿ƒé¡µé¢
- [x] é•¿æœŸè®°å¿† + çŸ¥è¯†åº“ RAG
- [x] åœ°å›¾ç»„ä»¶
- [x] æ¨¡æ‹Ÿæ¼”ç»ƒç³»ç»Ÿ
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆéœ€é…ç½® ANTHROPIC_API_KEYï¼‰
- [x] UI è´¨é‡å®¡æŸ¥

## ç¯å¢ƒå¤‡å¿˜
- é¡¹ç›®è·¯å¾„ï¼š`~/Desktop/claude-test/travel-agent/`
- å‰ç«¯ï¼šNext.js 16.1.6 (App Router) + TypeScript + Tailwind CSS v4
- Agent æœåŠ¡ï¼šPython 3.9.6 + FastAPI
- Python è™šæ‹Ÿç¯å¢ƒï¼š`agent/venv2/`ï¼ˆvenv å·²åºŸå¼ƒï¼Œè·¯å¾„ä¸å¯¹ï¼‰
- AI å¼•æ“ï¼šClaude APIï¼ˆéœ€åœ¨ .env é…ç½® ANTHROPIC_API_KEYï¼‰
- æ•°æ®åº“ï¼šPostgreSQL + Redisï¼ˆå¾…éƒ¨ç½²ï¼‰
- å‰ç«¯å¯åŠ¨ï¼š`cd web && npm run dev`
- Agent å¯åŠ¨ï¼š`./agent/venv2/bin/uvicorn agent.main:app --reload --port 8000`
- åç«¯ API åœ°å€ï¼š`http://localhost:8000`

## å‰ç«¯æ–‡ä»¶æ¸…å•
```
web/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ globals.css          # å…¨å±€æ ·å¼ + ä¸»é¢˜å˜é‡ + åŠ¨ç”»
â”‚   â”œâ”€â”€ layout.tsx           # å…¨å±€å¸ƒå±€ï¼ˆNavbarï¼‰
â”‚   â”œâ”€â”€ page.tsx             # é¦–é¡µï¼ˆHero + å¼•å¯¼å¡ç‰‡ï¼‰
â”‚   â””â”€â”€ chat/page.tsx        # å¯¹è¯é¡µï¼ˆå·¦å³å¸ƒå±€ + mock æµå¼å“åº”ï¼‰
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ Navbar.tsx       # é¡¶éƒ¨å¯¼èˆªæ ï¼ˆå“åº”å¼ï¼‰
â”‚   â”‚   â””â”€â”€ Footer.tsx       # åº•éƒ¨é¡µè„š
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ ChatContainer.tsx # å¯¹è¯å®¹å™¨ï¼ˆSSE æµå¼é€šä¿¡ + USE_MOCK å¼€å…³ï¼‰
â”‚   â”‚   â”œâ”€â”€ ChatMessage.tsx   # æ¶ˆæ¯æ°”æ³¡ï¼ˆMarkdown + UI å¡ç‰‡æ¸²æŸ“ï¼‰
â”‚   â”‚   â”œâ”€â”€ ChatInput.tsx     # è¾“å…¥æ¡†ï¼ˆè‡ªåŠ¨é«˜åº¦ + å¿«æ·é”®ï¼‰
â”‚   â”‚   â”œâ”€â”€ AgentStatus.tsx   # Agent æ€è€ƒçŠ¶æ€æŒ‡ç¤ºå™¨
â”‚   â”‚   â””â”€â”€ mockStream.ts     # Mock æµå¼å“åº”ï¼ˆåç«¯ä¸å¯ç”¨æ—¶å›é€€ï¼‰
â”‚   â””â”€â”€ cards/
â”‚       â”œâ”€â”€ FlightCard.tsx    # æœºç¥¨å¡ç‰‡
â”‚       â”œâ”€â”€ HotelCard.tsx     # é…’åº—å¡ç‰‡
â”‚       â”œâ”€â”€ POICard.tsx       # æ™¯ç‚¹å¡ç‰‡
â”‚       â”œâ”€â”€ WeatherCard.tsx   # å¤©æ°”å¡ç‰‡
â”‚       â”œâ”€â”€ TimelineCard.tsx  # æ—¶é—´çº¿å¡ç‰‡
â”‚       â””â”€â”€ BudgetChart.tsx   # é¢„ç®—å›¾è¡¨ï¼ˆçº¯ CSS æ¡å½¢å›¾ + æ˜ç»†è¡¨ï¼‰
â”œâ”€â”€ app/
â”‚   â””â”€â”€ itinerary/
â”‚       â””â”€â”€ [id]/page.tsx     # è¡Œç¨‹ç»“æœé¡µï¼ˆTab: æ—¶é—´çº¿/åœ°å›¾/é¢„ç®—ï¼‰
â””â”€â”€ lib/
    â”œâ”€â”€ types.ts              # TypeScript ç±»å‹å®šä¹‰ï¼ˆå« ItineraryData ç­‰ï¼‰
    â”œâ”€â”€ api-client.ts         # åç«¯ SSE é€šä¿¡å®¢æˆ·ç«¯
    â””â”€â”€ mock-itinerary.ts     # Mock è¡Œç¨‹æ•°æ®ï¼ˆä¸œäº¬+å¤§é˜ª 5 æ—¥æ¸¸ï¼‰
```

## åœ°å›¾ç»„ä»¶æ–‡ä»¶æ¸…å•
```
web/components/map/
â”œâ”€â”€ ItineraryMap.tsx          # Leaflet äº¤äº’å¼åœ°å›¾ï¼ˆæ ‡æ³¨+è·¯çº¿+å¼¹çª—+æ—¥æœŸç­›é€‰ï¼‰
â””â”€â”€ MapWrapper.tsx            # åŠ¨æ€å¯¼å…¥åŒ…è£…å™¨ï¼ˆSSR bypassï¼‰

ä¾èµ–ï¼šleaflet + react-leaflet + @types/leaflet
ç“¦ç‰‡ï¼šOpenStreetMapï¼ˆå…è´¹ï¼Œæ— éœ€ API Keyï¼‰
æ•°æ®ï¼šmock-itinerary.ts ä¸­ 26 ä¸ª POI å‡å« GeoLocation åæ ‡
```

## é•¿æœŸè®°å¿†æ–‡ä»¶æ¸…å•
```
agent/memory/
â”œâ”€â”€ profile.py                # ProfileManagerï¼šç”¨æˆ·ç”»åƒç®¡ç† + åå¥½å­¦ä¹  + ä¸ªæ€§åŒ–ä¸Šä¸‹æ–‡
â”œâ”€â”€ knowledge.py              # KnowledgeBaseï¼šå…³é”®è¯åŒ¹é…æ£€ç´¢ + æ—…è¡ŒçŸ¥è¯†åº“
â””â”€â”€ knowledge_data.py         # çŸ¥è¯†æ•°æ®æ¡ç›®ï¼ˆ20+æ¡ï¼šæ—¥æœ¬ç­¾è¯/æ³°å›½æ”»ç•¥/é€šç”¨å»ºè®®ç­‰ï¼‰
```

## å·¥å…·å±‚æ–‡ä»¶æ¸…å•
```
agent/tools/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ registry.py              # å·¥å…·æ³¨å†Œä¸­å¿ƒï¼ˆget_tool / list_tools / get_tools_for_agentï¼‰
â”œâ”€â”€ mcp/                     # MCP åŸå­å·¥å…·ï¼ˆmock å®ç°ï¼Œæ¥å£æ­£è§„ï¼‰
â”‚   â”œâ”€â”€ flight_search.py     # search_flights() - æœºç¥¨æœç´¢
â”‚   â”œâ”€â”€ hotel_search.py      # search_hotels() - é…’åº—æœç´¢
â”‚   â”œâ”€â”€ poi_search.py        # search_pois() - æ™¯ç‚¹/é¤å…/è´­ç‰©æœç´¢
â”‚   â”œâ”€â”€ weather_api.py       # get_weather() / get_weather_forecast() - å¤©æ°”æŸ¥è¯¢
â”‚   â”œâ”€â”€ map_service.py       # get_distance() / plan_route() - åœ°å›¾è·¯çº¿
â”‚   â””â”€â”€ currency.py          # convert_currency() / list_supported_currencies() - æ±‡ç‡
â””â”€â”€ skills/                  # ç»„åˆæŠ€èƒ½ï¼ˆè°ƒç”¨å¤šä¸ª MCP å·¥å…·ï¼‰
    â”œâ”€â”€ transit_optimizer.py  # optimize_transit() - äº¤é€šæœ€ä¼˜æ–¹æ¡ˆ
    â”œâ”€â”€ budget_allocator.py   # allocate_budget() - é¢„ç®—åˆ†é…
    â””â”€â”€ itinerary_optimizer.py # optimize_itinerary() - è¡Œç¨‹ä¼˜åŒ–

å…± 12 ä¸ªå·¥å…·ï¼ˆ9 MCP + 3 Skillsï¼‰ï¼Œè¦†ç›– 6 ä¸ª Agentã€‚
```

## æ¨¡æ‹Ÿæ¼”ç»ƒç³»ç»Ÿæ–‡ä»¶æ¸…å•
```
agent/simulator/
â”œâ”€â”€ __init__.py               # åŒ…å¯¼å‡º
â”œâ”€â”€ user_simulator.py         # ç”¨æˆ·æ¨¡æ‹Ÿå™¨ï¼š5ç§ç”»åƒ + å¯¹è¯ç”Ÿæˆ
â”œâ”€â”€ env_simulator.py          # ç¯å¢ƒæ¨¡æ‹Ÿå™¨ï¼šæ•…éšœæ³¨å…¥ + åœºæ™¯æ¨¡æ‹Ÿ
â”œâ”€â”€ evaluator.py              # AIè£åˆ¤ï¼š6ç»´åº¦è¯„ä¼°æŠ¥å‘Š
â””â”€â”€ scoring_rules.py          # è¯„åˆ†è§„åˆ™å¼•æ“ï¼ˆä»evaluatoræ‹†åˆ†ï¼‰

è°ƒè¯• API ç«¯ç‚¹ï¼ˆagent/main.pyï¼‰ï¼š
- GET  /api/debug/personas      # åˆ—å‡ºæ‰€æœ‰æ¨¡æ‹Ÿç”¨æˆ·ç”»åƒ
- POST /api/debug/simulate      # è¿è¡Œæ¨¡æ‹Ÿå¯¹è¯
- POST /api/debug/evaluate      # è¯„ä¼°å¯¹è¯è´¨é‡
- GET  /api/debug/scenarios     # åˆ—å‡ºæ‰€æœ‰æ¨¡æ‹Ÿåœºæ™¯
- POST /api/debug/inject-fault  # æ³¨å…¥æ•…éšœ
```

## å†å²å½’æ¡£
ï¼ˆæš‚æ— ï¼‰
